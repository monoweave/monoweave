---
path: "/getting-started"
title: "Getting Started"
---

export { Layout as default } from '../components/Layout'

## Getting Started

Prerequisites & Environment Supported:

- Node >=v20.18: For Node 18 support, you can continue to use Monoweave v1. Critical bugs may be backported upon request, however v1 has been stable for a while.
- Yarn Modern >=v4.6.0: We release a new minor version of Monoweave for any patch/minor update of Yarn. For optimal experience with monoweave, ensure you are on the latest version of Yarn at all times.
- Git >=2.13
- Ubuntu, macOS, and Windows are all supported and tested against.

Install `@monoweave/cli`:

```bash
yarn add -D @monoweave/cli
yarn monoweave
```

1. Edit your project's root `package.json` and set "workspaces": ["packages/*"] (you can use a different glob to match your monorepo layout).
2. Create a `monoweave.config.yaml` file and set it to:

   ```yaml
   preset: monoweave/preset-recommended # or preset-manual for changeset files
   ```

  You'll be extending this file as you make changes to your project's publish configuration.

3. If your packages require a compilation step (e.g. TypeScript, Babel), do this in a 'prepack' lifecycle hook per workspace. For more information about when prepack is called, [see Lifecycle Scripts](/architecture#lifecycle-scripts).

4. In CI, add a step:

  ```sh
  yarn monoweave
  ```

  By default, monoweave will create a release commit, add tags, and push the commit to your git remote. To disable the auto push (for example, if you want to create a pull request instead):

  ```sh
  yarn monoweave --no-push
  git push --tags
  ```

5. If using GitHub Actions, check out If using GitHub Actions, also check out our release preview reusable action: [monoweave/github-action-preview@main](https://github.com/monoweave/github-action-preview) to generate release previews on open pull requests.

### API

Monoweave supports both a Command Line Interface, as well as a Node API. Explanation of configuration options can be found at [Configuration](/configuration).

#### CLI

For the CLI, use the `--help` flag for a list of options.

```bash
yarn monoweave --help
```

The CLI provides a few sensible defaults, however if using the Node API, you will have to provide all relevant information.

You can also pass a `--config-file` flag to load options from a configuration file. The file should export an object matching the MonoweaveConfigFile interface. CLI flags take precedence over the configuration file.

Example config file (`monoweave.config.cjs`):

```js
module.exports = {
    git: {
        commitSha: 'HEAD',
        remote: 'origin',
        push: true,
    },
    conventionalChangelogConfig: 'conventional-changelog-angular',
    access: 'infer',
    persistVersions: false,
    changesetIgnorePatterns: ['**/*.test.js'],
}
```

or json/jsonc/json5/yml/yaml:

```yaml
git:
  commitSha: "HEAD"
  remote: "origin"
  push: true
conventionalChangelogConfig: "conventional-changelog-angular"
access: "infer"
persistVersions: false
changesetIgnorePatterns:
  - "**/*.test.js"
```

For an experience closer to the Yarn version plugin, or Atlassian's Changesets project, use the manual preset:

```js
module.exports = { preset: 'monoweave/preset-manual' }
```

and then commit change files generated via:

```sh
yarn monoweave version
```

This will suggest packages to release. You can filter the selection by using one or more globs:

```sh
yarn monoweave version "@my-scope/package-a" "@my-scope/package-*"
```

A non-interactive version is also supported:

```sh
yarn monoweave version --no-interactive --strategy=minor --message="Some changelog entry" "@my-scope/package-a"
```

In this mode, you are choosing _not_ to use conventional changelogs.

#### Node API

To use the API:

```ts
import type { MonoweaveConfiguration }  from '@monoweave/types'
import monoweave from '@monoweave/node'

const config: MonoweaveConfiguration = {
    cwd: process.cwd(),
    dryRun: false,
    git: {
        commitSha: 'HEAD',
        remote: 'origin',
        push: true,
    },
    conventionalChangelogConfig: 'conventional-changelog-angular',
    access: 'infer',
    persistVersions: false,
}
const changeset = await monoweave(config)
```

Note that configuration presets are not supported when using the Node API.

### Changelog

The recommended preset will create changelog entries within each individual package folder. It is equivalent to adding the `--changelog-filename "<packageDir>/CHANGELOG.md"` flag to the CLI. To aggregate changelog entries in a single changelog file, omit the `<packageDir>/` variable.

If adding monoweave to a project with existing changelogs, you'll need to add the a special marker to each changelog file to let monoweave know where to insert the changelog entries. For example:

```md
# My Example Changelog

Some blurb here.

<!-- MONOWEAVE:BELOW -->

## v1.0.0

Some entry.
```

The marker `<!-- MONOWEAVE:BELOW -->` must match exactly. It is whitespace and case-sensitive.

Monoweave uses a simplistic built-in changelog configuration, if a conventional changelog config is not specified, however it is recommended to use a conventional changelog config if possible.
